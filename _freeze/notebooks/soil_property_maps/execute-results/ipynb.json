{
  "hash": "9fc9c47638b6677eb29963c651ae4564",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Soil property mapping\"\nauthor: \"Alex Koiter\"\n---\n\n\n\n\n\n\n\n## Load libraries\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nsuppressPackageStartupMessages({\n  library(tidyverse)\n  library(terra)\n  library(patchwork)\n  library(sf)\n})\n```\n:::\n\n\n\n\n\n\n\n## Load data\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nag_data <- read_csv(here::here(\"./notebooks/ag_terrain_data.csv\"), show_col_types = FALSE) \n  # select(\"x\", \"y\", \"elevation\", \"ca\", \"mo\", \"u\", \"a_col\", \"h_col\", \"c_col\", \"organic\", \"ssa\")\n\nforest_data <- read_csv(here::here(\"./notebooks/forest_terrain_data.csv\"), show_col_types = FALSE) \n  # select(\"x\", \"y\", \"elevation\", \"li\", \"nb\", \"zn\", \"v_col\", \"l_col\")\n```\n:::\n\n\n\n\n\n\n\n## Agricultural soil properties\n### Geochemisty and colour\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nag_rast <- rast(ag_data)\ncrs(x = ag_rast, warn=FALSE) <- \"epsg:26914\"\n\ncoords <- read_csv(here::here(\"./notebooks/coords.csv\"), show_col_types = FALSE) %>% \n  st_as_sf(coords = c(\"long\", \"lat\"),  crs = 4326) %>%\n  st_transform(crs = 26914)\n\ntheme_right <-  theme(axis.title = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        legend.position = \"right\",\n        legend.box.spacing = unit(0, \"pt\"),\n        legend.margin=margin(0,0,0,3),\n        legend.justification=\"left\",\n        legend.title = element_text(hjust = 0))\ntheme_left <-  theme(axis.title = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        legend.position = \"left\",\n        legend.text.position = \"left\",\n        legend.box.spacing = unit(0, \"pt\"),\n        legend.margin=margin(0,3,0,0),\n        legend.justification=\"right\",\n        legend.title = element_text(hjust = 1))\n\na_col <- ggplot() +\n  tidyterra::geom_spatraster(data = ag_rast, aes(fill = a_col)) +\n  scale_fill_viridis_c(name = bquote(italic(\"a*\")), breaks = seq(2.5, 4, 0.5)) +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_left +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0))\n\nc_col <- ggplot() +\n  tidyterra::geom_spatraster(data = ag_rast, aes(fill = c_col)) +\n  scale_fill_viridis_c(name = bquote(italic(\"c*\")), breaks = seq(7, 11, 1)) +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) + \n  theme_left +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0))\n\nh_col <- ggplot() +\n  tidyterra::geom_spatraster(data = ag_rast, aes(fill = h_col)) +\n  scale_fill_viridis_c(name = bquote(italic(\"h*\")), breaks = seq(1.15, 1.25, 0.02)) +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_left +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0)) \n\nca <- ggplot() +\n  tidyterra::geom_spatraster(data = ag_rast, aes(fill = ca)) +\n  scale_fill_viridis_c(name = \"Ca\", limits = c(1, 9.2), breaks = seq(1, 9, 2)) +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_right +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0)) \n\nmo <- ggplot() +\n  tidyterra::geom_spatraster(data = ag_rast, aes(fill = mo)) +\n  scale_fill_viridis_c(name = \"Mo\", breaks = seq(0.5, 2, 0.5)) +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_right +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0)) \n\nu <- ggplot() +\n  tidyterra::geom_spatraster(data = ag_rast, aes(fill = u)) +\n  scale_fill_viridis_c(name = \"U\", breaks = seq(1.2, 1.8, 0.2)) +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_right +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0))\n```\n:::\n\n::: {#cell-fig-ag_map .cell}\n\n```{.r .cell-code .hidden}\n#| fig-width: 12\n#| fig-asp: 0.8\n#| label: fig-ag_map\n#| fig-cap: Kriged map of select colour (*a\\**, *c\\**, *h\\**) and geochemical (Ca, Mo, U) properties across the agricultural site.\n\na_col + ca + c_col + mo + h_col + u + \n  plot_layout(ncol = 2) \n```\n\n::: {.cell-output-display}\n![Kriged map of select colour (*a\\**, *c\\**, *h\\**) and geochemical (Ca, Mo, U) properties across the agricultural site.](soil_property_maps_files/figure-ipynb/fig-ag_map-1.png){#fig-ag_map}\n:::\n:::\n\n\n\n\n\n\n\n### Grain size, OM, elevation\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndem <- ggplot() +\n  tidyterra::geom_spatraster(data = ag_rast, aes(fill = elevation)) +\n  scale_fill_viridis_c(name = \"Elevation\", option = \"inferno\", limits = c(309, 312)) +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_left +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0))\n\nssa <- ggplot() +\n  tidyterra::geom_spatraster(data = ag_rast, aes(fill = ssa)) +\n  scale_fill_viridis_c(name = \"SSA\") +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_right +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0))\n\norganic <- ggplot() +\n  tidyterra::geom_spatraster(data = ag_rast, aes(fill = organic)) +\n  scale_fill_viridis_c(name = \"Organic\") +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_left +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0))\n\nscale_p <- ggplot() +\n  geom_sf(data = filter(coords, site == \"Agriculture\"), colour = \"white\") +\n  theme_void(base_size = 12)+\n  ggspatial::annotation_scale(location = \"bl\", width_hint = 0.4) +\n  ggspatial::annotation_north_arrow(location = \"bl\", pad_y  = unit(2, \"cm\"))\n```\n:::\n\n::: {#cell-fig-ag_map2 .cell}\n\n```{.r .cell-code .hidden}\n#| fig-width: 12\n#| fig-asp: 0.6\n#| label: fig-ag_map2\n#| fig-cap: Kriged map of organic matter content (%), specific surface area (m<sup>2</sup> kg<sup>-1</sup>), and elevation (m) across the agricultural site.\n\norganic + ssa + dem + scale_p + \n  plot_layout(ncol = 2) \n```\n\n::: {.cell-output-display}\n![Kriged map of organic matter content (%), specific surface area (m<sup>2</sup> kg<sup>-1</sup>), and elevation (m) across the agricultural site.](soil_property_maps_files/figure-ipynb/fig-ag_map2-1.png){#fig-ag_map2}\n:::\n:::\n\n\n\n\n\n\n\n## Agricultural soil properties\n### Geochemisty and colour\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nforest_rast <- rast(forest_data)\ncrs(x = forest_rast, warn=FALSE) <- \"epsg:26914\"\n\nh_col_forest <- ggplot() +\n  tidyterra::geom_spatraster(data = forest_rast, aes(fill = h_col)) +\n  scale_fill_viridis_c(name = bquote(italic(\"h*\")), limits =c(1.05, 1.25), breaks = seq(1.05, 1.25, 0.1)) +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_left +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0))\n\nl_col <- ggplot() +\n  tidyterra::geom_spatraster(data = forest_rast, aes(fill = l_col)) +\n  scale_fill_viridis_c(name = bquote(italic(\"L\")), limits =c(34, 60), breaks = seq(35, 60, 10)) +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) + \n  theme_left +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0))\n\nv_col <- ggplot() +\n  tidyterra::geom_spatraster(data = forest_rast, aes(fill = v_col)) +\n  scale_fill_viridis_c(name = bquote(italic(\"v*\")), breaks = seq(2, 7, 1)) +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_left +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0)) \n\nnb <- ggplot() +\n  tidyterra::geom_spatraster(data = forest_rast, aes(fill = nb)) +\n  scale_fill_viridis_c(name = \"Nb\", breaks = seq(0.25, 0.5, 0.05)) +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_right +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0)) \n\nli <- ggplot() +\n  tidyterra::geom_spatraster(data = forest_rast, aes(fill = li)) +\n  scale_fill_viridis_c(name = \"Li\", breaks = seq(4, 9, 1)) +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_right +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0)) \n\nzn <- ggplot() +\n  tidyterra::geom_spatraster(data = forest_rast, aes(fill = zn)) +\n  scale_fill_viridis_c(name = \"Zn\", breaks = seq(50, 350, 50)) +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_right +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0))\n```\n:::\n\n::: {#cell-fig-forest_map .cell}\n\n```{.r .cell-code .hidden}\n#| fig-width: 12\n#| fig-asp: 0.8\n#| label: fig-forest_map\n#| fig-cap: Kriged map of select colour (*h\\**, *c\\**, *v\\**) and geochemical (Li, Nb, Zn) properties across the forested site.\n\nh_col_forest + li + l_col + nb + v_col + zn + \n  plot_layout(ncol = 2) \n```\n\n::: {.cell-output-display}\n![Kriged map of select colour (*h\\**, *c\\**, *v\\**) and geochemical (Li, Nb, Zn) properties across the forested site.](soil_property_maps_files/figure-ipynb/fig-forest_map-1.png){#fig-forest_map}\n:::\n:::\n\n\n\n\n\n\n\n### Grain size, OM, elevation\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndem_forest <- ggplot() +\n  tidyterra::geom_spatraster(data = forest_rast, aes(fill = elevation)) +\n  scale_fill_viridis_c(name = \"Elevation\", option = \"inferno\") +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_left +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0))\n\nssa_forest <- ggplot() +\n  tidyterra::geom_spatraster(data = forest_rast, aes(fill = ssa)) +\n  scale_fill_viridis_c(name = \"SSA\") +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_right +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0))\n\norganic_forest <- ggplot() +\n  tidyterra::geom_spatraster(data = forest_rast, aes(fill = organic)) +\n  scale_fill_viridis_c(name = \"Organic\") +\n  #geom_sf(data = filter(coords, site == \"Agriculture\")) +\n  theme_minimal(base_size = 12) +\n  theme_left +\n  scale_y_continuous(expand = c(0,0)) +\n  scale_x_continuous(expand = c(0,0))\n\nscale_p_forest <- ggplot() +\n  geom_sf(data = filter(coords, site == \"Forest\"), colour = \"white\") +\n  theme_void(base_size = 12)+\n  ggspatial::annotation_scale(location = \"bl\", width_hint = 0.3) +\n  ggspatial::annotation_north_arrow(location = \"bl\", pad_y  = unit(2, \"cm\"))\n```\n:::\n\n::: {#cell-fig-forest_map2 .cell}\n\n```{.r .cell-code .hidden}\n#| fig-width: 12\n#| fig-asp: 0.6\n#| label: fig-forest_map2\n#| fig-cap: Kriged map of organic matter content (%), specific surface area (m<sup>2</sup> kg<sup>-1</sup>), and elevation (m) across the forested site.\n\norganic_forest + ssa_forest + dem_forest + scale_p_forest + \n  plot_layout(ncol = 2) \n```\n\n::: {.cell-output-display}\n![Kriged map of organic matter content (%), specific surface area (m<sup>2</sup> kg<sup>-1</sup>), and elevation (m) across the forested site.](soil_property_maps_files/figure-ipynb/fig-forest_map2-1.png){#fig-forest_map2}\n:::\n:::\n",
    "supporting": [
      "soil_property_maps_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}