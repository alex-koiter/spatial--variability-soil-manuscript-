{
  "hash": "5d0ff0133086dc23aeafebc38ad7a9c5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Random Forest results\"\nauthor: \"Alex Koiter\"\n---\n\n\n\n## Load libraries\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nsuppressPackageStartupMessages({\n  library(tidyverse)\n  library(patchwork)\n})\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nimp_data <- read_csv(here::here(\"./notebooks/importance_data.csv\")) %>%\n  rename(\"Terrain Attribute\" = \"Var.Names\") %>%\n  mutate(`Terrain Attribute` = fct_recode(`Terrain Attribute`, \"Elevation\" = \"elevation\", \n                                          \"Catchment Area\" = \"catchment_area\",\n                                          \"Plan Curvature\" = \"plan_curvature\",\n                                          \"Profile Curvature\" = \"profile_curvature\",\n                                          \"Rel. Slope Position\" = \"relative_slope_position\",\n                                          \"SAGA Wetness Index\" = \"saga_wetness_index\",\n                                          \"Vert. Dist. Channel\" = \"vertical_distance_channel_network\")) %>%\n  mutate(`Terrain Attribute` = fct_relevel(`Terrain Attribute`, \"Elevation\", \"Rel. Slope Position\", \"Vert. Dist. Channel\", \"SAGA Wetness Index\", \"Catchment Area\", \"Profile Curvature\", \"Plan Curvature\")) %>%\n  mutate(property = fct_recode(property, \"italic(`a*`)\" = \"a_col\", \"italic(`c*`)\" = \"c_col\", \"italic(`h*`)\" = \"h_col\", \n    \"italic(`L`)\" = \"l_col\",  \"italic(`v*`)\" = \"v_col\")) %>%\n  mutate(property = fct_relevel(property, \"Ca\", \"Li\", \"Mo\", \"Nb\", \"U\", \"Zn\", \"italic(`a*`)\", \"italic(`c*`)\",  \"italic(`L`)\", \"italic(`v*`)\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 85 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): Var.Names, site, property\ndbl (4): %IncMSE, IncNodePurity, MSE_rank, Purity_rank\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\navg <- imp_data %>%\n  group_by(`Terrain Attribute`) %>%\n  summarise(total = mean(MSE_rank)) %>%\n  arrange(total) |>\n  mutate(MSE_rank = 1:n(),\n         property = \"Overall\")\n\navg_site<- imp_data %>%\n  group_by(`Terrain Attribute`, site) %>%\n  summarise(total = mean(MSE_rank)) %>%\n  group_by(site) %>%\n  arrange(total) |>\n  mutate(MSE_rank = 1:n(),\n         property = site)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`summarise()` has grouped output by 'Terrain Attribute'. You can override using\nthe `.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\noverall <- avg_site %>%\n  bind_rows(avg) %>%\n  mutate(facet = \"Average\") %>%\n  mutate(`Terrain Attribute` = fct_relevel(`Terrain Attribute`, \"Elevation\", \"Rel. Slope Position\", \"Vert. Dist. Channel\", \"SAGA Wetness Index\", \"Catchment Area\", \"Profile Curvature\", \"Plan Curvature\"))\n\ng1 <- ggplot(data = imp_data, aes(x = as.factor(MSE_rank), y = property, fill = `Terrain Attribute`)) + \n  geom_tile() +\n  theme_bw() +\n  viridis::scale_fill_viridis(discrete = TRUE) +\n  theme(axis.title.y = element_blank()) +\n  labs(x = \"Importance Ranking \\n(% Increase in Mean Squared Error)\") +\n  scale_y_discrete(labels = scales::label_parse(), limits=rev, expand = c(0,0)) +\n  scale_x_discrete(expand = c(0,0)) +\n  facet_wrap(~site, ncol = 1, scales = \"free_y\", strip.position = \"right\")\n\ng2 <- ggplot(data = overall, aes(x = as.factor(MSE_rank), y = property, fill = `Terrain Attribute`)) + \n  geom_tile() +\n  theme_bw() +\n  scale_y_discrete(expand = c(0,0)) +\n  scale_x_discrete(expand = c(0,0)) +\n  viridis::scale_fill_viridis(discrete = TRUE) +\n  theme(axis.text.x = element_blank(), axis.title.x = element_blank(), axis.ticks.x = element_blank(),\n        axis.title.y = element_blank())  +\n  facet_wrap(~facet, ncol = 1, scales = \"free_y\", strip.position = \"right\")\n```\n:::\n\n::: {#cell-fig-RF-results .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-RF-results\n#| fig-cap: Heat map of the Random Forest regresssion results showing the ranking of the importance of terrain attributes (based on % increase in Mean Squared Error) in explaining the spatial variabilty of selected colour and geochemical properties within the agricultural and forested sites. Top panel shows an average ranking for each site and across both sites.\n\ng2 + g1 + plot_layout(ncol = 1, heights = c(2, 10), guides = \"collect\") & theme(legend.position = 'right')\n```\n\n::: {.cell-output-display}\n![Heat map of the Random Forest regresssion results showing the ranking of the importance of terrain attributes (based on % increase in Mean Squared Error) in explaining the spatial variabilty of selected colour and geochemical properties within the agricultural and forested sites. Top panel shows an average ranking for each site and across both sites.](RF_results_files/figure-ipynb/fig-RF-results-1.png){#fig-RF-results}\n:::\n:::\n",
    "supporting": [
      "RF_results_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}