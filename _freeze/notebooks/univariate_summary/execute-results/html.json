{
  "hash": "ded57a6369a8ac155f810c5727f14efc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Univariate summary\"\nauthor: \"Alex Koiter\"\n---\n\n\n\n## Load libraries\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n:::\n\n\n\n# load in data\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndata <- read_csv(here::here(\"./notebooks/soil_data.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 6078 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): site, element, group\ndbl (2): sample_number, value\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n## Summarize\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndata_summary <- data %>%\n  group_by(element) %>%\n  group_by(element, site, group) %>%\n  summarise(mean = mean(value, na.rm = T),\n            sd = sd(value, na.rm = T),\n            max = max(value, na.rm = T),\n            min = min(value, na.rm = T),\n            se = sd(value)/ sqrt(length(value)),\n            skewness = moments::skewness(value),\n            cv = sd(value, na.rm = TRUE) / mean(value, na.rm = TRUE) * 100, .groups = \"drop\") \n```\n:::\n\n\n\n\n### Max-min scaling\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndata2 <- data %>%\n  group_by(element) %>%\n  mutate(value2 = (value - min(value, na.rm = T)) / (max(value, na.rm = T) - min(value, na.rm = T))) %>%\n  group_by(element, site, group) %>%\n  summarise(mean = mean(value2, na.rm = T),\n            sd = sd(value2, na.rm = T),\n            max = max(value2, na.rm = T),\n            min = min(value2, na.rm = T),\n            se = sd(value2)/ sqrt(length(value2)),\n            skewness = moments::skewness(value2),\n            cv = sd(value, na.rm = TRUE) / mean(value, na.rm = TRUE) * 100, .groups = \"drop\") %>%\n  mutate(spacer = case_when(site == \"Forest\" ~ 1.1,\n                            site == \"Agriculture\"~ 1.2))\n```\n:::\n\n\n## Geochemistry\n### plot prep\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ngeo <- data2 %>%\n  filter(group == \"geochem\") %>%\n  mutate(facet = case_when(element %in% c(\"Ag\", \"Al\", \"As\",\"B\",\"Ba\",\"Be\",\"Bi\",\"Ca\",\"Cd\",\"Ce\",\"Co\", \"Cr\", \"Cs\", \"Cu\", \"Fe\", \"Ga\", \"Hf\", \"Hg\", \"In\", \"K\", \"La\", \"Li\") ~ \"Geomchemistry A-L\",\n                          element %in% c(\"Mg\", \"Mn\", \"Mo\", \"Nb\", \"Ni\", \"P\", \"Pb\", \"Rb\", \"S\", \"Sb\", \"Sc\", \"Se\", \"Sn\", \"Sr\", \"Te\", \"Th\", \"Tl\", \"U\", \"V\", \"Y\", \"Zn\", \"Zr\") ~ \"Geomchemistry M-Z\",\n                          TRUE~ NA)) %>%\n  mutate(bar = rep(c(rep(Inf, 2), rep(0, 2)), n()/4)) %>%\n  pivot_longer(cols = c(mean, max, min), names_to = \"variable\") \n\ngeo2 <- data2 %>%\n  filter(group == \"geochem\") %>%\n    mutate(facet = case_when(element %in% c(\"Ag\", \"Al\", \"As\",\"B\",\"Ba\",\"Be\",\"Bi\",\"Ca\",\"Cd\",\"Ce\",\"Co\", \"Cr\", \"Cs\", \"Cu\", \"Fe\", \"Ga\", \"Hf\", \"Hg\", \"In\", \"K\", \"La\", \"Li\") ~ \"Geomchemistry A-L\",\n                          element %in% c(\"Mg\", \"Mn\", \"Mo\", \"Nb\", \"Ni\", \"P\", \"Pb\", \"Rb\", \"S\", \"Sb\", \"Sc\", \"Se\", \"Sn\", \"Sr\", \"Te\", \"Th\", \"Tl\", \"U\", \"V\", \"Y\", \"Zn\", \"Zr\") ~ \"Geomchemistry M-Z\",\n                          TRUE~ NA)) %>%\n  mutate(bar = rep(c(rep(Inf, 2), rep(0, 2)), n()/4))\n\ngeo3 <- data2 %>%\n  filter(group == \"geochem\") %>%\n    mutate(facet = case_when(element %in% c(\"Ag\", \"Al\", \"As\",\"B\",\"Ba\",\"Be\",\"Bi\",\"Ca\",\"Cd\",\"Ce\",\"Co\", \"Cr\", \"Cs\", \"Cu\", \"Fe\", \"Ga\", \"Hf\", \"Hg\", \"In\", \"K\", \"La\", \"Li\") ~ \"Geomchemistry A-L\",\n                          element %in% c(\"Mg\", \"Mn\", \"Mo\", \"Nb\", \"Ni\", \"P\", \"Pb\", \"Rb\", \"S\", \"Sb\", \"Sc\", \"Se\", \"Sn\", \"Sr\", \"Te\", \"Th\", \"Tl\", \"U\", \"V\", \"Y\", \"Zn\", \"Zr\") ~ \"Geomchemistry M-Z\",\n                          TRUE~ NA)) %>%\n  mutate(bar = rep(c(rep(-Inf, 2), rep(0, 2)), n()/4))\n```\n:::\n\n\n\n### plot\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nggplot() +\n  theme_bw(base_size = 12) +\n  geom_bar(data = geo2, aes(x=element, y = bar), fill =\"grey20\", position=\"identity\", stat = \"identity\", alpha = 0.1) +\n  geom_bar(data = geo3, aes(x=element, y = bar), fill =\"grey20\", position=\"identity\", stat = \"identity\", alpha = 0.1) +\n  geom_errorbar(data = geo2, aes(x = element, ymin = mean - sd, ymax = mean + sd, colour = site), width = .1, position = position_dodge(width = 0.5)) +\n  geom_point(data = filter(geo, variable == \"mean\"), aes(x = element, y = value, colour = site, shape = variable), position = position_dodge(width = 0.5), show.legend = TRUE, size = 1.5) +\n  geom_point(data = filter(geo, variable == \"max\"), aes(x = element, y = value, colour = site, shape = variable), position = position_dodge(width = 0.5), show.legend = TRUE, size = 1.5) +\n  geom_point(data = filter(geo, variable == \"min\"), aes(x = element, y = value, colour = site, shape = variable), position = position_dodge(width = 0.5), show.legend = TRUE, size = 1.5) +\n  geom_text(data = geo3, aes(x = element, y = spacer, colour = site, label = formatC(cv, digits = 1, format = \"f\")), show.legend = FALSE, size = 3) +\n  guides(color=guide_legend(override.aes=list(shape=NA))) +\n  scale_shape_manual(values=c(3, 19, 4)) +\n  scale_color_viridis_d(begin = 0.2, end = 0.7) +\n  scale_y_continuous(breaks = seq(0, 1, 0.2)) +\n  theme(legend.position = \"bottom\",\n        legend.title = element_blank()) +\n  labs(y = \"Scaled Concentration\", x = \"Element\") +\n  facet_wrap(~facet, ncol = 1, scales = \"free_x\")\n```\n\n::: {.cell-output-display}\n![](univariate_summary_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n## Plot2\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nggplot(data = filter(data, group == \"geochem\"), aes(x = site, y = value, fill = site))+\n  geom_boxplot() +\n  theme_bw(base_size = 12) +\n  scale_fill_viridis_d(begin = 0.2, end = 0.7) +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +\n  labs(x = \"Site\", y = \"Concentration\") +\n  facet_wrap(~element, scales = \"free_y\")\n```\n\n::: {.cell-output-display}\n![](univariate_summary_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n### Table\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ngeo_tab <- data_summary %>%\n  filter(group == \"geochem\") %>%\n  select(-group) \n\nknitr::kable(geo_tab, digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|element |site        |    mean|      sd|      max|     min|     se| skewness|     cv|\n|:-------|:-----------|-------:|-------:|--------:|-------:|------:|--------:|------:|\n|Ag      |Agriculture |   0.106|   0.021|    0.220|   0.080|  0.003|    3.302| 19.927|\n|Ag      |Forest      |   0.072|   0.015|    0.130|   0.040|  0.002|    1.109| 20.428|\n|Al      |Agriculture |   1.274|   0.090|    1.430|   0.970|  0.013|   -0.607|  7.099|\n|Al      |Forest      |   0.668|   0.109|    0.890|   0.440|  0.016|    0.229| 16.391|\n|As      |Agriculture |   9.351|   2.067|   14.200|   6.900|  0.295|    1.008| 22.101|\n|As      |Forest      |   4.845|   1.436|    8.100|   1.700|  0.205|    0.270| 29.640|\n|B       |Agriculture |  31.633|   3.734|   40.000|  30.000|  0.533|    1.822| 11.805|\n|B       |Forest      |  15.918|   4.966|   20.000|  10.000|  0.709|   -0.374| 31.196|\n|Ba      |Agriculture | 154.898|  19.378|  190.000| 130.000|  2.768|    0.328| 12.510|\n|Ba      |Forest      | 173.878|  54.575|  390.000|  60.000|  7.796|    1.854| 31.387|\n|Be      |Agriculture |   0.959|   0.081|    1.130|   0.750|  0.012|    0.009|  8.423|\n|Be      |Forest      |   0.462|   0.067|    0.670|   0.350|  0.010|    0.451| 14.536|\n|Bi      |Agriculture |   0.250|   0.032|    0.380|   0.200|  0.005|    1.764| 12.774|\n|Bi      |Forest      |   0.178|   0.031|    0.230|   0.110|  0.004|   -0.484| 17.444|\n|Ca      |Agriculture |   4.001|   2.187|    8.780|   0.950|  0.312|    0.277| 54.664|\n|Ca      |Forest      |   1.887|   1.530|    5.460|   0.470|  0.219|    1.067| 81.120|\n|Cd      |Agriculture |   0.592|   0.057|    0.720|   0.480|  0.008|   -0.008|  9.604|\n|Cd      |Forest      |   0.518|   0.284|    1.760|   0.210|  0.041|    2.875| 54.782|\n|Ce      |Agriculture |  36.800|   2.359|   41.000|  31.800|  0.337|   -0.244|  6.411|\n|Ce      |Forest      |  31.190|   5.532|   46.800|  21.400|  0.790|    0.524| 17.736|\n|Co      |Agriculture |   8.755|   0.830|   10.600|   7.500|  0.119|    0.521|  9.479|\n|Co      |Forest      |   6.757|   1.393|    9.600|   4.000|  0.199|    0.030| 20.622|\n|Cr      |Agriculture |  23.388|   1.935|   26.000|  17.000|  0.276|   -0.630|  8.271|\n|Cr      |Forest      |  13.408|   1.567|   17.000|  10.000|  0.224|    0.090| 11.686|\n|Cs      |Agriculture |   0.745|   0.148|    1.070|   0.470|  0.021|    0.182| 19.926|\n|Cs      |Forest      |   0.553|   0.120|    0.780|   0.340|  0.017|    0.249| 21.734|\n|Cu      |Agriculture |  25.169|   2.264|   30.400|  20.100|  0.323|    0.104|  8.997|\n|Cu      |Forest      |  13.145|   2.816|   23.100|  10.100|  0.402|    1.786| 21.425|\n|Fe      |Agriculture |   1.918|   0.090|    2.110|   1.710|  0.013|   -0.255|  4.702|\n|Fe      |Forest      |   1.182|   0.133|    1.460|   0.830|  0.019|   -0.584| 11.239|\n|Ga      |Agriculture |   4.202|   0.341|    4.830|   3.140|  0.049|   -0.594|  8.120|\n|Ga      |Forest      |   2.209|   0.277|    2.770|   1.650|  0.040|    0.097| 12.533|\n|Hf      |Agriculture |   0.154|   0.038|    0.220|   0.080|  0.005|   -0.086| 24.639|\n|Hf      |Forest      |   0.116|   0.028|    0.170|   0.060|  0.004|    0.104| 23.798|\n|Hg      |Agriculture |   0.043|   0.007|    0.050|   0.030|  0.001|   -0.459| 16.499|\n|Hg      |Forest      |   0.056|   0.018|    0.100|   0.030|  0.003|    0.379| 32.290|\n|In      |Agriculture |   0.031|   0.003|    0.036|   0.023|  0.000|   -0.351|  8.553|\n|In      |Forest      |   0.018|   0.003|    0.027|   0.011|  0.000|    0.236| 17.736|\n|K       |Agriculture |   0.222|   0.045|    0.310|   0.140|  0.006|    0.436| 20.440|\n|K       |Forest      |   0.187|   0.033|    0.240|   0.100|  0.005|   -0.294| 17.849|\n|La      |Agriculture |  18.231|   1.223|   20.200|  15.500|  0.175|   -0.293|  6.708|\n|La      |Forest      |  15.000|   2.596|   21.800|  10.300|  0.371|    0.330| 17.308|\n|Li      |Agriculture |  15.622|   1.423|   19.800|  12.800|  0.203|    0.618|  9.108|\n|Li      |Forest      |   6.465|   0.898|    8.600|   4.300|  0.128|   -0.022| 13.887|\n|Mg      |Agriculture |   0.765|   0.097|    0.970|   0.520|  0.014|   -0.511| 12.617|\n|Mg      |Forest      |   0.615|   0.559|    1.770|   0.200|  0.080|    1.023| 90.906|\n|Mn      |Agriculture | 865.143| 318.206| 1800.000| 468.000| 45.458|    0.940| 36.781|\n|Mn      |Forest      | 996.367| 313.072| 2050.000| 277.000| 44.725|    1.014| 31.421|\n|Mo      |Agriculture |   0.932|   0.410|    2.350|   0.470|  0.059|    1.182| 43.951|\n|Mo      |Forest      |   0.757|   0.193|    1.190|   0.390|  0.028|    0.570| 25.552|\n|Nb      |Agriculture |   0.589|   0.057|    0.730|   0.460|  0.008|    0.452|  9.669|\n|Nb      |Forest      |   0.372|   0.064|    0.560|   0.170|  0.009|   -0.677| 17.103|\n|Ni      |Agriculture |  29.627|   2.716|   35.700|  25.000|  0.388|    0.356|  9.169|\n|Ni      |Forest      |  18.092|   3.898|   28.000|  11.000|  0.557|    0.328| 21.548|\n|P       |Agriculture | 701.429|  72.342|  860.000| 560.000| 10.335|    0.154| 10.313|\n|P       |Forest      | 749.184| 117.948|  990.000| 520.000| 16.850|    0.053| 15.744|\n|Pb      |Agriculture |  11.702|   0.798|   13.200|   9.900|  0.114|   -0.198|  6.815|\n|Pb      |Forest      |  11.941|   8.419|   68.000|   7.100|  1.203|    6.192| 70.507|\n|Rb      |Agriculture |  18.429|   4.326|   26.700|  10.200|  0.618|    0.244| 23.477|\n|Rb      |Forest      |  13.831|   1.853|   18.100|   9.900|  0.265|    0.273| 13.397|\n|S       |Agriculture |   0.120|   0.071|    0.270|   0.040|  0.010|    0.770| 59.479|\n|S       |Forest      |   0.060|   0.019|    0.110|   0.030|  0.003|    0.506| 31.894|\n|Sb      |Agriculture |   0.446|   0.049|    0.560|   0.350|  0.007|    0.230| 11.078|\n|Sb      |Forest      |   0.270|   0.090|    0.650|   0.120|  0.013|    1.301| 33.332|\n|Sc      |Agriculture |   3.149|   0.338|    3.800|   2.300|  0.048|   -0.256| 10.732|\n|Sc      |Forest      |   1.624|   0.237|    2.000|   1.000|  0.034|   -0.572| 14.574|\n|Se      |Agriculture |   1.616|   0.535|    2.700|   0.700|  0.076|    0.182| 33.085|\n|Se      |Forest      |   0.896|   0.371|    2.600|   0.400|  0.053|    2.522| 41.386|\n|Sn      |Agriculture |   0.647|   0.058|    0.800|   0.500|  0.008|    0.120|  8.981|\n|Sn      |Forest      |   0.398|   0.090|    0.900|   0.300|  0.013|    3.492| 22.644|\n|Sr      |Agriculture |  91.314|  38.981|  163.500|  38.600|  5.569|    0.093| 42.689|\n|Sr      |Forest      |  32.427|  12.605|   64.200|  15.300|  1.801|    0.983| 38.872|\n|Te      |Agriculture |   0.046|   0.008|    0.070|   0.030|  0.001|    0.402| 17.736|\n|Te      |Forest      |   0.034|   0.007|    0.050|   0.020|  0.001|   -0.022| 21.598|\n|Th      |Agriculture |   2.565|   0.504|    3.600|   1.600|  0.072|   -0.084| 19.629|\n|Th      |Forest      |   2.173|   1.216|    7.300|   1.000|  0.174|    2.185| 55.932|\n|Tl      |Agriculture |   0.169|   0.035|    0.240|   0.110|  0.005|    0.365| 20.763|\n|Tl      |Forest      |   0.153|   0.034|    0.230|   0.090|  0.005|    0.325| 22.199|\n|U       |Agriculture |   1.475|   0.186|    1.940|   1.200|  0.027|    0.591| 12.638|\n|U       |Forest      |   1.026|   0.254|    1.740|   0.630|  0.036|    0.359| 24.792|\n|V       |Agriculture |  67.857|   4.198|   77.000|  55.000|  0.600|   -0.363|  6.187|\n|V       |Forest      |  34.122|   4.910|   44.000|  25.000|  0.701|    0.269| 14.390|\n|Y       |Agriculture |  11.291|   0.726|   12.600|   9.750|  0.104|   -0.427|  6.431|\n|Y       |Forest      |   8.435|   2.005|   12.200|   4.370|  0.286|   -0.348| 23.766|\n|Zn      |Agriculture |  93.796|   7.681|  106.000|  75.000|  1.097|   -0.222|  8.189|\n|Zn      |Forest      | 109.551|  53.267|  318.000|  42.000|  7.610|    1.425| 48.623|\n|Zr      |Agriculture |   6.063|   1.321|    8.600|   3.500|  0.189|   -0.103| 21.781|\n|Zr      |Forest      |   4.135|   0.916|    7.200|   2.300|  0.131|    1.123| 22.164|\n\n\n:::\n:::\n\n\n## Colour\n### plot prep\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ncolour <- data2 %>%\n  filter(group == \"colour\") %>%\n  mutate(element = str_extract(element, (\"[:alpha:](?=_)\"))) %>% # remove _col\n  mutate(bar = c(rep(c(rep(Inf, 2), rep(0, 2)), 7), Inf, Inf)) %>%\n  pivot_longer(cols = c(mean, max, min), names_to = \"variable\") \n\ncolour2 <- data2 %>%\n  filter(group == \"colour\") %>%\n  mutate(element = str_extract(element, (\"[:alpha:](?=_)\"))) %>% # remove _col\n  mutate(bar = c(rep(c(rep(Inf, 2), rep(0, 2)), 7), Inf, Inf))\n\ncolour3 <- data2 %>%\n  filter(group == \"colour\") %>%\n  mutate(element = str_extract(element, (\"[:alpha:](?=_)\"))) %>% # remove _col\n  mutate(bar = c(rep(c(rep(-Inf, 2), rep(0, 2)), 7), -Inf, -Inf))\n```\n:::\n\n\n\n### plot\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nggplot() +\n  theme_bw(base_size = 12) +\n  geom_bar(data = colour2, aes(x=element, y = bar), fill =\"grey20\", position=\"identity\", stat = \"identity\", alpha = 0.1) +\n  geom_bar(data = colour3, aes(x=element, y = bar), fill =\"grey20\", position=\"identity\", stat = \"identity\", alpha = 0.1) +\n  geom_errorbar(data = colour2, aes(x = element, ymin = mean - sd, ymax = mean + sd, colour = site), width = .1, position = position_dodge(width = 0.5)) +\n  geom_point(data = filter(colour, variable == \"mean\"), aes(x = element, y = value, colour = site, shape = variable), position = position_dodge(width = 0.5), show.legend = TRUE, size = 2) +\n  geom_point(data = filter(colour, variable == \"max\"), aes(x = element, y = value, colour = site, shape = variable), position = position_dodge(width = 0.5), show.legend = TRUE, size = 2) +\n  geom_point(data = filter(colour, variable == \"min\"), aes(x = element, y = value, colour = site, shape = variable), position = position_dodge(width = 0.5), show.legend = TRUE, size = 2) +\n  geom_text(data = colour3, aes(x = element, y = spacer, colour = site, label = formatC(cv, digits = 1, format = \"f\")), show.legend = FALSE, size = 4) +\n  guides(color=guide_legend(override.aes=list(shape=NA))) +\n  scale_shape_manual(values=c(3, 19, 4)) +\n  scale_color_viridis_d(begin = 0.2, end = 0.7) +\n  scale_y_continuous(breaks = seq(0, 1, 0.2)) +\n  theme(legend.position = \"bottom\",\n        legend.title = element_blank()) +\n  labs(y = \"Scaled value\", x = \"Colour coefficient\") \n```\n\n::: {.cell-output-display}\n![](univariate_summary_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n## Plot2\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nggplot(data = filter(data, group == \"colour\"), aes(x = site, y = value, fill = site))+\n  geom_boxplot() +\n  theme_bw(base_size = 12) +\n  scale_fill_viridis_d(begin = 0.2, end = 0.7) +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +\n  labs(x = \"Site\", y = \"Value\") +\n  facet_wrap(~element, scales = \"free_y\")\n```\n\n::: {.cell-output-display}\n![](univariate_summary_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n### Table\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ncolour_tab <- data_summary %>%\n  filter(group == \"colour\") %>%\n  mutate(element = str_extract(element, (\"[:alpha:](?=_)\"))) %>% # remove _col\n  select(-group) \n\nknitr::kable(colour_tab, digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|element |site        |    mean|     sd|     max|     min|    se| skewness|     cv|\n|:-------|:-----------|-------:|------:|-------:|-------:|-----:|--------:|------:|\n|B       |Agriculture | 108.713|  7.138| 124.075|  90.820| 1.020|   -0.068|  6.566|\n|B       |Forest      |  91.596| 12.252| 115.728|  65.214| 1.750|   -0.026| 13.376|\n|G       |Agriculture | 121.574|  7.814| 138.629| 101.553| 1.116|    0.085|  6.427|\n|G       |Forest      | 108.599| 15.617| 139.062|  76.917| 2.231|    0.043| 14.380|\n|L       |Agriculture |  51.993|  3.097|  58.684|  43.914| 0.442|    0.066|  5.956|\n|L       |Forest      |  47.451|  6.346|  59.480|  34.342| 0.907|   -0.022| 13.373|\n|R       |Agriculture | 132.290|  8.146| 149.933| 111.218| 1.164|    0.153|  6.158|\n|R       |Forest      | 125.584| 16.808| 157.058|  91.971| 2.401|   -0.014| 13.384|\n|X       |Agriculture |  23.306|  3.162|  30.618|  15.890| 0.452|    0.357| 13.567|\n|X       |Forest      |  19.909|  5.772|  32.219|   9.801| 0.825|    0.295| 28.993|\n|Y       |Agriculture |  20.261|  2.772|  26.688|  13.779| 0.396|    0.349| 13.680|\n|Y       |Forest      |  16.846|  4.963|  27.550|   8.173| 0.709|    0.315| 29.458|\n|Z       |Agriculture |   5.638|  0.779|   7.438|   3.838| 0.111|    0.234| 13.822|\n|Z       |Forest      |   4.113|  1.148|   6.640|   2.007| 0.164|    0.284| 27.910|\n|a       |Agriculture |   3.383|  0.322|   4.152|   2.586| 0.046|   -0.026|  9.531|\n|a       |Forest      |   5.732|  0.407|   6.562|   4.411| 0.058|   -0.378|  7.095|\n|b       |Agriculture |   8.842|  0.973|  10.587|   6.689| 0.139|   -0.183| 11.004|\n|b       |Forest      |  12.469|  2.009|  15.909|   8.016| 0.287|    0.221| 16.109|\n|c       |Agriculture |   9.468|  1.017|  11.324|   7.172| 0.145|   -0.189| 10.741|\n|c       |Forest      |  13.739|  1.943|  16.998|   9.149| 0.278|    0.149| 14.145|\n|h       |Agriculture |   1.205|  0.013|   1.234|   1.180| 0.002|    0.185|  1.116|\n|h       |Forest      |   1.134|  0.047|   1.225|   1.056| 0.007|    0.342|  4.130|\n|u       |Agriculture |   8.075|  0.816|   9.774|   6.202| 0.117|   -0.137| 10.101|\n|u       |Forest      |  12.749|  1.379|  14.839|   8.750| 0.197|   -0.298| 10.812|\n|v       |Agriculture |   3.803|  0.438|   4.659|   2.956| 0.063|   -0.065| 11.529|\n|v       |Forest      |   4.788|  1.041|   6.620|   2.772| 0.149|    0.307| 21.739|\n|x       |Agriculture |   0.474|  0.002|   0.479|   0.468| 0.000|    0.064|  0.462|\n|x       |Forest      |   0.487|  0.002|   0.492|   0.482| 0.000|   -0.208|  0.466|\n|y       |Agriculture |   0.412|  0.001|   0.413|   0.410| 0.000|   -0.291|  0.146|\n|y       |Forest      |   0.412|  0.002|   0.415|   0.409| 0.000|    0.416|  0.424|\n\n\n:::\n:::\n\n\n\n## PSA and organic matter\n### plot prep\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\npsa <- data2 %>%\n  filter(group %in% c(\"psa\", \"organic\")) %>%\n  mutate(bar = c(rep(c(rep(Inf, 2), rep(0, 2)), 1), Inf, Inf)) %>%\n  pivot_longer(cols = c(mean, max, min), names_to = \"variable\") \n\npsa2 <- data2 %>%\n  filter(group %in% c(\"psa\", \"organic\")) %>%\n  mutate(bar = c(rep(c(rep(Inf, 2), rep(0, 2)), 1), Inf, Inf)) \n\npsa3 <- data2 %>%\n  filter(group %in% c(\"psa\", \"organic\")) %>%\n  mutate(bar = c(rep(c(rep(-Inf, 2), rep(0, 2)), 1), -Inf, -Inf))\n```\n:::\n\n\n\n### plot\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nggplot() +\n  theme_bw(base_size = 12) +\n  geom_bar(data = psa2, aes(x=element, y = bar), fill =\"grey20\", position=\"identity\", stat = \"identity\", alpha = 0.1) +\n  geom_bar(data = psa3, aes(x=element, y = bar), fill =\"grey20\", position=\"identity\", stat = \"identity\", alpha = 0.1) +\n  geom_errorbar(data = psa2, aes(x = element, ymin = mean - sd, ymax = mean + sd, colour = site), width = .2, position = position_dodge(width = 0.5)) +\n  geom_point(data = filter(psa, variable == \"mean\"), aes(x = element, y = value, colour = site, shape = variable), position = position_dodge(width = 0.5), show.legend = TRUE, size = 2) +\n  geom_point(data = filter(psa, variable == \"max\"), aes(x = element, y = value, colour = site, shape = variable), position = position_dodge(width = 0.5), show.legend = TRUE, size = 2) +\n  geom_point(data = filter(psa, variable == \"min\"), aes(x = element, y = value, colour = site, shape = variable), position = position_dodge(width = 0.5), show.legend = TRUE, size = 2) +\n  geom_text(data = psa3, aes(x = element, y = spacer, colour = site, label = formatC(cv, digits = 1, format = \"f\")), show.legend = FALSE, size = 5) +\n  guides(color=guide_legend(override.aes=list(shape=NA))) +\n  scale_shape_manual(values=c(3, 19, 4)) +\n  scale_color_viridis_d(begin = 0.2, end = 0.7) +\n  scale_y_continuous(breaks = seq(0, 1, 0.2)) +\n  theme(legend.position = \"bottom\",\n        legend.title = element_blank()) +\n  labs(y = \"Scaled value\", x = \"Soil property\") \n```\n\n::: {.cell-output-display}\n![](univariate_summary_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n\n## Plot2\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nggplot(data = filter(data, group %in% c(\"psa\", \"organic\")), aes(x = site, y = value, fill = site))+\n  geom_boxplot() +\n  theme_bw(base_size = 12) +\n  scale_fill_viridis_d(begin = 0.2, end = 0.7) +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +\n  labs(x = \"Site\", y = \"Value\") +\n  facet_wrap(~element, scales = \"free_y\")\n```\n\n::: {.cell-output-display}\n![](univariate_summary_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n### Table\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\npsa_tab <- data_summary %>%\n  filter(group %in% c(\"psa\", \"organic\")) %>%\n  select(-group) \n\nknitr::kable(psa_tab, digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|element |site        |     mean|      sd|      max|      min|     se| skewness|     cv|\n|:-------|:-----------|--------:|-------:|--------:|--------:|------:|--------:|------:|\n|dx_50   |Agriculture |    5.437|   0.484|    7.305|    4.638|  0.069|    1.177|  8.908|\n|dx_50   |Forest      |   16.747|   5.030|   28.992|    8.492|  0.711|    0.662| 30.034|\n|organic |Agriculture |    8.508|   1.373|   11.363|    5.863|  0.196|    0.068| 16.132|\n|organic |Forest      |   11.551|   5.993|   26.987|    1.373|  0.856|    0.372| 51.886|\n|ssa     |Agriculture | 1853.021| 187.324| 2195.720| 1458.533| 26.761|    0.000| 10.109|\n|ssa     |Forest      |  763.475| 133.484| 1032.611|  492.593| 18.878|   -0.084| 17.484|\n\n\n:::\n:::",
    "supporting": [
      "univariate_summary_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}